{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Firesummary\"\nauthor: \"Derek Corcoran\"\ndate: \"August 25, 2016\"\noutput: html_document\n---\n\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(cache=FALSE)\n```\n\n#Abstract\n\nThis webpage will show the results of a bat survey study done in the Plumas National Forest in North California. The objective of this study is to determine the distribution of the different species of bats within the park. In order to do that we have performed occupancy models for the species present in the park. The results of this models will be shown as maps showing the probability of occurence of bats in each point, that is, if you see a value of 1, there is a 100% chance of finding a bat in that point, if there is a value of 0 there is 0% chance of finding that specie in that point, if there is a value of 0.5 there is a 50% chance of finding that specie in that point.\n\nAnother result\n\n```{r, message=FALSE, warning=FALSE, echo=FALSE,results='hide'}\n#first load libraries\nlibrary(raster)\nlibrary(rasterVis)\nlibrary(maps)\nlibrary(maptools)\nlibrary(rgdal)\nlibrary(latticeExtra)\nlibrary(dplyr)\nlibrary(knitr)\nlibrary(unmarked)\nlibrary(lubridate)\nlibrary(jpeg)\nlibrary(stargazer)\nlibrary(xtable)\nlibrary(MuMIn)\nlibrary(ggplot2)\nlibrary(RCurl)\nlibrary(foreign)\nlibrary(caret)\nlibrary(AICcmodavg)\n```\n\n```{r,echo=FALSE,warning=FALSE,message=FALSE,results='hide', cache=TRUE}\nPredictors<- readRDS(\"Predictors_Stack.rds\")\nplot(Predictors)\n```\n\n```{r,echo=FALSE, warning=FALSE,message=FALSE}\nGrandtotal <- read.csv(\"~/LastBat/Grandtotal.csv\")\nGrandtotal <- Grandtotal[,-1]\n\nsampling.cov<- Grandtotal[,53:83]\nsampling.cov <- sampling.cov[,-c(7,8,17:22)]\n#This next step changes according to the models\npreprocov <-preProcess(sampling.cov[,15:23], method = c(\"center\",\"scale\"))\nsampling.cov<-predict(preprocov, sampling.cov[,15:23])\n\nDailycov <- Grandtotal[,84:110]\n\n\npreproDaily <-preProcess(Dailycov, method = c(\"center\",\"scale\"))\nDailycov<-predict(preproDaily, Dailycov)\n\nJulian<-Dailycov[,1:3]\nMax.hum<-Dailycov[,4:6]\nMax.temp<-Dailycov[,7:9]\nMean.hum<-Dailycov[,10:12]\nMean.temp<-Dailycov[,13:15]\nMin.hum<-Dailycov[,16:18]\nMin.temp<-Dailycov[,19:21]\nSd.hum<-Dailycov[,22:24]\nSd.temp<-Dailycov[,25:27]\n\nDailycov<- list(Julian,Max.hum, Max.temp, Mean.hum,Mean.temp, Min.hum, Min.temp, Sd.hum, Sd.temp)\nnames(Dailycov) <- c(\"Julian\", \"Maxhum\",\"Maxtemp\",\"Meanhum\", \"Meantemp\",\"Minhum\",\"Mintemp\",\"sdhum\",\"sdtemp\")\n\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}\n\nPred.DF<-as.data.frame(Predictors)\n\n\nPred.DF<-predict(preprocov, new=Pred.DF)\n\nDistance.to.water <- Predictors[[1]]  # this will be the template\nDistance.to.water[] <- NA \nvalues(Distance.to.water)<-Pred.DF[,1]\n\nDistance.to.road <- Predictors[[1]]  # this will be the template\nDistance.to.road[] <- NA \nvalues(Distance.to.road)<-Pred.DF[,2]\n\nExisting.vegetation <- Predictors[[1]]  # this will be the template\nExisting.vegetation[] <- NA \nvalues(Existing.vegetation)<-Pred.DF[,3]\n\nAltitude <- Predictors[[1]]  # this will be the template\nAltitude[] <- NA \nvalues(Altitude)<-Pred.DF[,4]\n     \nBurn.intensity.soil <- Predictors[[1]]  # this will be the template\nBurn.intensity.soil[] <- NA \nvalues(Burn.intensity.soil)<-Pred.DF[,5]\n\nBurn.intensity.Canopy <- Predictors[[1]]  # this will be the template\nBurn.intensity.Canopy[] <- NA \nvalues(Burn.intensity.Canopy)<-Pred.DF[,6]\n\nBurn.intensity.basal <- Predictors[[1]]  # this will be the template\nBurn.intensity.basal[] <- NA \nvalues(Burn.intensity.basal)<-Pred.DF[,7]\n\nfire_dist <- Predictors[[1]]  # this will be the template\nfire_dist[] <- NA \nvalues(fire_dist)<-Pred.DF[,8]\n\nforest_dist <- Predictors[[1]]  # this will be the template\nforest_dist[] <- NA \nvalues(forest_dist)<-Pred.DF[,9]\n\nPredictors <-stack(Distance.to.water, Distance.to.road, Existing.vegetation, Altitude, Burn.intensity.soil,Burn.intensity.Canopy, Burn.intensity.basal, fire_dist, forest_dist)\nnames(Predictors)<-c(\"Distance to water\", \"Distance to road\",\"Existing vegetation\",\"Altitude\", \"Burn intensity soil\",\"Burn intensity Canopy\", \"Burn intensity basal\", \"fire_dist\", \"forest_dist\")\n\n\nplot(Predictors)\n```\n\n#Results collected in the field \n\n\n\n#Maps showing the sampled Points\n\n\n#Results of species prescence\n\nIn this area 0 means absence, and 1 means prescence. This table has for each site (ID), every specie and day, so for example if Mylu1=0, that means that for *Myotis lucifugus* (common name Little Brown bat, was detected on day one for that particular site).\n\n##Here is a key for bat species\n\n- *Myotis yumanensis* (Myyu)\n- *Myotis californicus* (Myca)\n- *Myotis ciliolabrum* (Myci)\n- *Myotis volans* (Myvo)\n- *Myotis lucifugus* (Mylu)\n- *Parastrellus hesperus* (Pahe)\n- *Lasiurus blossevillii* (Labo)\n- *Myotis evotis* (Myev)\n- *Antrozous pallidus*  **(Anpa)**\n- *Eptesicus fuscus* (Epfu)\n- *Lasionycteris noctivagans* (Lano)\n- *Myotis thysanodes* **(Myth)**\n- *Tadarida brasiliensis* (Tabr)\n- *Lasiurus cinereus* (Laci)\n- *Corynorhinus townsendii* **(Coto)**\n- *Euderma maculatum* (Euma)\n- *Eumops perotis* (Eupe)\n\n```{r,echo=FALSE, warning=FALSE,message=FALSE}\nBatOccu <- Grandtotal[,2:52]\n```\n\n#Maps predicting the distribution of bats\n\n##Yuma myotis (*Myotis yumanensis*)\n\n```{r, echo=FALSE,message=FALSE}\nlibrary(unmarked)\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results=\"hide\"}\n#N=49a\nBatOccuMyYu<-BatOccu[,2:4]\n\nSimOccuMyYu2<-unmarkedFrameOccu(y = BatOccuMyYu, siteCovs =sampling.cov, obsCovs=Dailycov)\n\n# Fit model with psi held constant\nmodel.Occu1.My.Yu2 <- occu(~ Julian + Meanhum + Meantemp + sdhum + sdtemp + Maxhum + Maxtemp + Minhum + Mintemp~  1, SimOccuMyYu2)\n\nselect.My.Yu2 <- dredge(model.Occu1.My.Yu2, rank = \"AICc\")\nlibrary(texreg)\nhtmlreg(extract(subset(select.My.Yu2, delta <= 1, recalc.weights = FALSE)))\n\nmodel.Occu1.My.Yu2 <- occu(~ Meantemp ~ Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2) + fire_dist + forest_dist,SimOccuMyYu2)\n\nselect.My.Yu2 <- dredge(model.Occu1.My.Yu2, rank = \"AICc\", subset= !(  \n`psi(Burn.intensity.Canopy)` && `psi(Burn.intensity.basal)` ||\n`psi(Burn.intensity.Canopy)` && `psi(I(Burn.intensity.basal^2))` ||\n`psi(I(Burn.intensity.Canopy^2))` && `psi(Burn.intensity.basal)` ||\n`psi(I(Burn.intensity.Canopy^2))` && `psi(I(Burn.intensity.basal^2))`)& `p(Meantemp)`)\n\nbest2.My.Yu2<-get.models(select.My.Yu2, 1)[[1]]\nOccu1.layer.MyYu2 <- predict(best2.My.Yu2, type = \"state\", newdata=Predictors)\n\nbrks= c(0, 0.1, 0.2, 0.3, 0.4,0.5, 0.6,0.7, 0.8,0.9, 1)\ncols <- rev(terrain.colors(10))\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results=\"asis\"}\n\nplot(Occu1.layer.MyYu2$Predicted, colNA=\"black\", main=\"Occupancy estimation for Yuma Myotis\",breaks=brks, lab.breaks=brks, col=cols, zlim=c(0,1))\n\n#library(texreg)\nhtmlreg(extract(subset(select.My.Yu2, delta <= 2, recalc.weights = TRUE)), file = \"myyu.doc\")\n\nhtmlreg(extract(subset(select.My.Yu2, delta <= 2, recalc.weights = TRUE)))\n```\n\n##California bat (*Myotis californicus*)\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuMyCa<-BatOccu[,5:7]\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results=\"hide\"}\n\nSimOccuMyCa2<-unmarkedFrameOccu(y = BatOccuMyCa, siteCovs =sampling.cov, obsCovs=Dailycov)\n\nmodel.Occu1.My.Ca2 <- occu(~ Julian + Meanhum + Meantemp + sdhum + sdtemp + Maxhum + Maxtemp + Minhum + Mintemp~  1, SimOccuMyCa2)\n\nselect.My.Ca2 <- dredge(model.Occu1.My.Ca2, rank = \"AICc\")\n\nmodel.Occu1.My.Ca2 <- occu(~ sdtemp ~ Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2) + fire_dist + forest_dist, SimOccuMyCa2)\n\nselect.My.Ca2 <- dredge(model.Occu1.My.Ca2, rank = \"AICc\", subset= !(\n`psi(Burn.intensity.Canopy)` && `psi(Burn.intensity.basal)` ||\n`psi(Burn.intensity.Canopy)` && `psi(I(Burn.intensity.basal^2))` ||\n`psi(I(Burn.intensity.Canopy^2))` && `psi(Burn.intensity.basal)` ||\n`psi(I(Burn.intensity.Canopy^2))` && `psi(I(Burn.intensity.basal^2))`) & `p(sdtemp)`)\n\nbest2.My.Ca2<-get.models(select.My.Ca2, 1)[[1]]\nOccu1.layer.MyCa2 <- predict(best2.My.Ca2, type = \"state\", newdata=Predictors)\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results=\"asis\"}\nOccu1.layer.MyCa<-Occu1.layer.MyCa2\nplot(Occu1.layer.MyCa$Predicted, colNA=\"black\", main=\"Occupancy estimation for California Bat\",breaks=brks, col=cols,lab.breaks=brks, zlim=c(0,1))\nlibrary(texreg)\nhtmlreg(extract(subset(select.My.Ca2, delta <= 2, recalc.weights = TRUE)))\n```\n\n\n##Western Small Footed Myotis (*Myotis ciliolabrum*)\n\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuMyCi<-BatOccu[,8:10]\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nSimOccuMyCi2<-unmarkedFrameOccu(y = BatOccuMyCi, siteCovs =sampling.cov, obsCovs=Dailycov)\n\nmodel.Occu1.My.Ci2 <- occu(~ Julian + Meanhum + Meantemp + sdhum + sdtemp + Maxhum + Maxtemp + Minhum + Mintemp~  1, SimOccuMyCi2)\n\nselect.My.Ci2 <- dredge(model.Occu1.My.Ci2, rank = \"AICc\")\n\nmodel.Occu1.My.Ci2 <- occu(~ Meantemp ~ Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2) + fire_dist + forest_dist, SimOccuMyCi2)\n\nselect.My.Ci2 <- dredge(model.Occu1.My.Ci2, rank = \"AICc\", subset= !( \n`psi(Burn.intensity.Canopy)` && `psi(Burn.intensity.basal)` ||\n`psi(Burn.intensity.Canopy)` && `psi(I(Burn.intensity.basal^2))` ||\n`psi(I(Burn.intensity.Canopy^2))` && `psi(Burn.intensity.basal)` ||\n`psi(I(Burn.intensity.Canopy^2))` && `psi(I(Burn.intensity.basal^2))`) & `p(Meantemp)`)\n\nbest2.My.Ci2<-get.models(select.My.Ci2, 1)[[1]]\nOccu1.layer.MyCi2 <- predict(best2.My.Ci2, type = \"state\", newdata=Predictors)\n\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results=\"asis\"}\n\nOccu1.layer.MyCi<-Occu1.layer.MyCi2\nplot(Occu1.layer.MyCi$Predicted, colNA=\"black\", main=\"Occupancy estimation for Western Small Footed Myotis\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n\nlibrary(texreg)\nhtmlreg(extract(subset(select.My.Ci2, delta <= 2, recalc.weights = TRUE)))\n```\n\n##Hairy-winged bat (*Myotis volans*)\n\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\nBatOccuMyVo<-BatOccu[,11:13]\n```\n\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\nSimOccuMyVo2<-unmarkedFrameOccu(y = BatOccuMyVo, siteCovs =sampling.cov, obsCovs=Dailycov)\n\nmodel.Occu1.My.Vo2 <- occu(~ Julian + Meanhum + Meantemp + sdhum + sdtemp + Maxhum + Maxtemp + Minhum + Mintemp~  1, SimOccuMyVo2)\n\nselect.My.Vo2 <- dredge(model.Occu1.My.Vo2, rank = \"AICc\")\n\n#library(texreg)\n#htmlreg(extract(subset(select.My.Vo2, delta <= 2, recalc.weights = TRUE)))\n\nmodel.Occu1.My.Vo2 <- occu(~ sdhum ~ Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2) + fire_dist + forest_dist, SimOccuMyVo2)\n\nselect.My.Vo2 <- dredge(model.Occu1.My.Vo2, rank = \"AICc\", subset= !( \n`psi(Burn.intensity.Canopy)` && `psi(Burn.intensity.basal)` ||\n`psi(Burn.intensity.Canopy)` && `psi(I(Burn.intensity.basal^2))` ||\n`psi(I(Burn.intensity.Canopy^2))` && `psi(Burn.intensity.basal)` ||\n`psi(I(Burn.intensity.Canopy^2))` && `psi(I(Burn.intensity.basal^2))`))\n\nbest2.My.Vo2<-get.models(select.My.Vo2, 1)[[1]]\n\nOccu1.layer.MyVo2 <- predict(best2.My.Vo2, type = \"state\", newdata=Predictors)\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results=\"asis\"}\n\nOccu1.layer.MyVo<-Occu1.layer.MyVo2\nplot(Occu1.layer.MyVo$Predicted, colNA=\"black\", main=\"Occupancy estimation for Hairy-winged bat\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n\nlibrary(texreg)\nhtmlreg(extract(subset(select.My.Vo2, delta <= 2, recalc.weights = TRUE)))\n\n```\n\n##Little Brown bat (*Myotis lucifugus*)\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\n#N=49\nBatOccuMyLu<-BatOccu[,14:16]\n\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results='hide'}\nSimOccuMyLu2<-unmarkedFrameOccu(y = BatOccuMyLu, siteCovs =sampling.cov, obsCovs=Dailycov)\n\nmodel.Occu1.My.Lu2 <-  occu(~ Julian + Meanhum + Meantemp + sdhum + sdtemp + Maxhum + Maxtemp + Minhum + Mintemp~  1, SimOccuMyLu2)\n\nselect.My.Lu2 <- dredge(model.Occu1.My.Lu2, rank = \"AICc\")\n\n#library(texreg)\n#htmlreg(extract(subset(select.My.Lu2, delta <= 2, recalc.weights = TRUE)))\n\nmodel.Occu1.My.Lu2 <- occu(~ sdhum ~ Burn.intensity.Canopy + I(Burn.intensity.Canopy^2) + Burn.intensity.basal + I(Burn.intensity.basal^2) + fire_dist + forest_dist, SimOccuMyLu2)\n\nselect.My.Lu2 <- dredge(model.Occu1.My.Lu2, rank = \"AICc\", subset= !(  \n`psi(Burn.intensity.Canopy)` && `psi(Burn.intensity.basal)` ||\n`psi(Burn.intensity.Canopy)` && `psi(I(Burn.intensity.basal^2))` ||\n`psi(I(Burn.intensity.Canopy^2))` && `psi(Burn.intensity.basal)` ||\n`psi(I(Burn.intensity.Canopy^2))` && `psi(I(Burn.intensity.basal^2))`) & `p(sdhum)`)\n\nbest2.My.Lu2<-get.models(select.My.Lu2, 1)[[1]]\nOccu1.layer.MyLu2 <- predict(best2.My.Lu2, type = \"state\", newdata=Predictors)\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE, results=\"asis\"}\nlibrary(texreg)\n\nOccu1.layer.MyLu2<-Occu1.layer.MyLu2\nplot(Occu1.layer.MyLu2$Predicted, colNA=\"black\", main=\"Occupancy estimation for Little Brown Bat\",breaks=brks, col=cols, lab.breaks=brks, zlim=c(0,1))\n\nhtmlreg(extract(subset(select.My.Lu2, delta <= 2, recalc.weights = TRUE)))\n```\n",
    "created" : 1472158023936.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1924137827",
    "id" : "24E32A13",
    "lastKnownWriteTime" : 1472224170,
    "last_content_update" : 1472224170858,
    "path" : "~/LastBat/firesummary.Rmd",
    "project_path" : "firesummary.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}